> يقدم هذا المستند شرحًا تفصيليًا للكود المصدري لمنصة راصد الوطنية، ويقدم رؤى حول بنية وهدف وتنفيذ الملفات والمكونات الرئيسية. يعتمد التحليل على ملف التحليل الرئيسي ويهدف إلى منح المطورين فهمًا شاملاً لقاعدة الكود.

## 1. المجلدات والملفات الرئيسية

يوضح الجدول التالي المجلدات والملفات الرئيسية في قاعدة كود منصة راصد الوطنية، إلى جانب وظائفها الأساسية:

| المسار | الوصف |
| --- | --- |
| `client/src/` | مجلد الكود المصدري الرئيسي لتطبيق الواجهة الأمامية. |
| `client/src/App.tsx` | مكون التطبيق الرئيسي المسؤول عن التوجيه والتخطيط. |
| `client/src/main.tsx` | نقطة الدخول لتطبيق React. |
| `client/src/components/` | يحتوي على مكونات React القابلة لإعادة الاستخدام والمستخدمة في جميع أنحاء التطبيق. |
| `client/src/pages/` | يحتوي على مكونات الصفحة الرئيسية للمسارات المختلفة. |
| `client/src/contexts/` | يحتوي على مزودي سياق React لإدارة الحالة. |
| `server/` | مجلد الكود المصدري الرئيسي لتطبيق الواجهة الخلفية. |

## 2. تحليل المكونات

يقدم هذا القسم تفصيلاً للمكونات التي تشكل اللبنات الأساسية لواجهة المستخدم.

### 2.1. المكونات الأساسية

| المكون | الوصف |
| --- | --- |
| `AnimatedCounter.tsx` | عداد متحرك يتزايد من قيمة بداية إلى قيمة مستهدفة. |
| `BookmarkButton.tsx` | زر يسمح للمستخدمين بوضع إشارة مرجعية على المحتوى. |
| `CommentsSection.tsx` | مكون يعرض قائمة بالتعليقات ويسمح للمستخدمين بإضافة تعليقات جديدة. |
| `ErrorBoundary.tsx` | حدود خطأ React لالتقاط ومعالجة الأخطاء في شجرة مكوناته. |
| `FloatingParticles.tsx` | مكون يعرض جزيئات عائمة للتأثير البصري. |
| `Footer.tsx` | التذييل القياسي للتطبيق. |
| `GuidedTour.tsx` | مكون يوفر جولة إرشادية للمستخدمين الجدد. |
| `Layout.tsx` | مكون التخطيط الرئيسي الذي يلتف حول محتوى الصفحة. |
| `LikeButton.tsx` | زر يسمح للمستخدمين بالإعجاب بالمحتوى. |
| `MediaViewer.tsx` | مكون مشروط لعرض الوسائط مثل الصور ومقاطع الفيديو. |
| `Navbar.tsx` | شريط التنقل الرئيسي للتطبيق. |
| `NotificationBell.tsx` | مكون يعرض جرس إشعارات مع عدد الإشعارات غير المقروءة. |
| `PageTransition.tsx` | مكون يوفر انتقالًا متحركًا بين الصفحات. |
| `PdfReportButton.tsx` | زر يقوم بإنشاء وتنزيل تقرير PDF. |
| `PresentationMode.tsx` | مكون يتيح وضع عرض تقديمي بملء الشاشة. |
| `PresentationToolbar.tsx` | شريط الأدوات لوضع العرض التقديمي. |
| `RealtimeNotifications.tsx` | مكون يتعامل مع الإشعارات في الوقت الفعلي. |
| `RichTextEditor.tsx` | محرر نصوص منسقة يعتمد على Tiptap لإنشاء وتحرير المحتوى. |
| `ScrollProgressBar.tsx` | شريط تقدم يشير إلى موضع تمرير المستخدم على الصفحة. |
| `SectionHeader.tsx` | مكون رأس لأقسام الصفحة. |

### 2.2. مكونات واجهة المستخدم (shadcn/ui)

يستخدم التطبيق مجموعة من مكونات واجهة المستخدم من `shadcn/ui`، والتي تم إنشاؤها فوق Radix UI.

| المكون | الوصف |
| --- | --- |
| `avatar.tsx` | مكون الصورة الرمزية. |
| `badge.tsx` | مكون شارة لعرض الحالة أو التسميات. |
| `button.tsx` | مكون زر قياسي. |
| `card.tsx` | مكون بطاقة لتجميع المحتوى. |
| `checkbox.tsx` | مكون مربع اختيار. |
| `dialog.tsx` | مكون حوار أو مشروط. |
| `dropdown-menu.tsx` | مكون قائمة منسدلة. |
| `input.tsx` | حقل إدخال قياسي. |
| `label.tsx` | تسمية لعناصر النموذج. |
| `popover.tsx` | مكون منبثق. |
| `scroll-area.tsx` | مكون بمنطقة قابلة للتمرير. |
| `select.tsx` | مكون تحديد أو قائمة منسدلة. |
| `separator.tsx` | خط فاصل. |
| `sheet.tsx` | مكون ورقة أو درج ينزلق من الجانب. |
| `sonner.tsx` | مكون إشعار منبثق. |
| `switch.tsx` | مكون تبديل. |
| `tabs.tsx` | مكون علامات تبويب لتنظيم المحتوى. |
| `textarea.tsx` | مكون منطقة نصية لإدخال نص متعدد الأسطر. |
| `tooltip.tsx` | مكون تلميح. |

## 3. إدارة الحالة

يستخدم التطبيق **React Query (TanStack Query)** لإدارة حالة الخادم. تبسط هذه المكتبة جلب البيانات والتخزين المؤقت والمزامنة مع الواجهة الخلفية.

- **`ThemeContext.tsx`**: يستخدم هذا السياق لإدارة سمة التطبيق (الوضع الداكن/الفاتح).

## 4. التوجيه

يستخدم التطبيق **Wouter** للتوجيه. يتم تحديد المسارات الرئيسية في `App.tsx`، الذي يعين مسارات URL إلى مكونات الصفحة المقابلة لها.

| المسار | مكون الصفحة | الوصف |
| --- | --- | --- |
| `/` | `Home.tsx` | الصفحة الرئيسية للتطبيق. |
| `/news` | `NewsPage.tsx` | يعرض قائمة بالمقالات الإخبارية. |
| `/news/:id` | `NewsDetailPage.tsx` | يعرض تفاصيل مقال إخباري واحد. |
| `/videos` | `VideosPage.tsx` | يعرض قائمة بمقاطع الفيديو. |
| `/gallery` | `GalleryPage.tsx` | يعرض معرضًا للصور. |
| `/login` | `LoginPage.tsx` | صفحة تسجيل دخول المستخدم. |
| `/dashboard` | `DashboardPage.tsx` | لوحة تحكم المسؤول. |

## 5. واجهة برمجة تطبيقات الواجهة الخلفية (tRPC)

تم بناء الواجهة الخلفية باستخدام **tRPC**، والذي يسمح بمسارات API آمنة من حيث النوع. يتم تنظيم إجراءات tRPC حسب الميزة.

### 5.1. المصادقة (`auth`)

- **الاستعلامات**: `me`
- **التعديلات**: `localLogin`, `logout`, `changePassword`, `requestPasswordReset`, `resetPassword`, `updateProfile`, `uploadAvatar`

### 5.2. الأخبار (`news`)

- **الاستعلامات**: `list`, `all`, `latest`, `getById`
- **التعديلات**: `create`, `update`, `delete`

### 5.3. مقاطع الفيديو (`videos`)

- **الاستعلامات**: `list`, `all`
- **التعديلات**: `create`, `update`, `delete`
