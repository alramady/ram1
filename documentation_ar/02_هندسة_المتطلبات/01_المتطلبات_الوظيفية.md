# منصة راصد الوطنية: هندسة المتطلبات

يحدد هذا المستند المتطلبات الوظيفية وغير الوظيفية لمنصة راصد الوطنية، وهي نظام بيئي رقمي شامل لإدارة ونشر المعلومات الرسمية. ويفصل أدوار المستخدمين وميزات النظام والمواصفات الفنية لتوجيه عملية التطوير والتنفيذ.

## 1. أدوار المستخدمين والشخصيات

تم تصميم المنصة لخدمة قاعدة مستخدمين متنوعة بأدوار وصلاحيات متميزة. تضمن هذه الأدوار بيئة منظمة وآمنة لإدارة المحتوى والإدارة والوصول العام.

| الدور | الوصف | المسؤوليات الرئيسية |
| --- | --- | --- |
| **المسؤول (Administrator)** | لديه سيطرة كاملة على النظام، بما في ذلك إدارة المستخدمين وإعدادات النظام والإشراف على المحتوى. | - إدارة حسابات المستخدمين وأدوارهم<br>- تكوين الإعدادات على مستوى النظام (مثل SMTP)<br>- مراقبة نشاط النظام والتحليلات<br>- الإشراف على جميع المحتويات |
| **مشرف المحتوى (Content Moderator)** | يراجع ويوافق على المحتوى المقدم من المحررين والمستخدمين الآخرين لضمان مطابقته لمعايير الجودة والامتثال. | - مراجعة والموافقة/رفض الأخبار ومقاطع الفيديو والمحتويات الأخرى<br>- التأكد من التزام المحتوى بإرشادات المنصة<br>- إدارة جدولة المحتوى ونشره |
| **المحرر (Editor)** | يقوم بإنشاء وتحرير وإدارة أنواع مختلفة من المحتوى، مثل المقالات الإخبارية ومقاطع الفيديو والأدلة. | - إنشاء وتحرير المحتوى<br>- تقديم المحتوى للموافقة<br>- إدارة العلامات والفئات |
| **عضو (Member)** | مستخدم مسجل لديه حق الوصول إلى محتوى وميزات حصرية غير متاحة لعامة الناس. | - الوصول إلى المحتوى والخدمات الحصرية للأعضاء<br>- إدارة الملف الشخصي والإشارات المرجعية<br>- التفاعل مع ميزات المجتمع (مثل التعليقات والإعجابات) |
| **مستخدم (User)** | مستخدم مسجل لديه حق الوصول الأساسي إلى ميزات المنصة. | - الوصول إلى المحتوى العام<br>- إدارة الملف الشخصي والإشارات المرجعية<br>- التفاعل مع ميزات المجتمع |
| **زائر (Viewer)** | مستخدم ضيف يمكنه تصفح وعرض المحتوى العام دون الحاجة إلى تسجيل حساب. | - عرض الأخبار العامة ومقاطع الفيديو والمحتويات الأخرى |

## 2. المتطلبات الوظيفية

تحدد المتطلبات الوظيفية السلوكيات والميزات المحددة للنظام. وهي مصنفة إلى ميزات موجهة للجمهور ووظائف خاصة بالمستخدم وقدرات إدارية.

### 2.1. الميزات العامة والأساسية

هذه الميزات متاحة لجميع المستخدمين، بما في ذلك الضيوف غير المسجلين، وتشكل جوهر البوابة الموجهة للجمهور.

- **الصفحة الرئيسية:** صفحة هبوط ديناميكية (`/`) تعرض آخر الأخبار والمحتوى المميز والإعلانات الرئيسية.
- **بوابة الأخبار:** قسم مخصص للمقالات الإخبارية (`/news`)، مع صفحة قائمة وعرض تفصيلي (`/news/:id`) لكل مقال.
- **معارض الوسائط:** أقسام منفصلة لمعارض الفيديو (`/videos`) والصور (`/gallery`)، مما يسمح للمستخدمين بتصفح وعرض محتوى الوسائط المتعددة.
- **مكتبات الموارد:** مستودعات مركزية للوثائق الرسمية والأدلة (`/guides`) والعروض التقديمية (`/presentations`) والروابط الخارجية (`/links`).
- **وظيفة البحث:** ميزة بحث عالمية (`/search`) تمكن المستخدمين من العثور على المحتوى عبر المنصة بأكملها.
- **مصادقة المستخدم:** وظائف تسجيل دخول آمنة للمستخدم (`/login`) وإعادة تعيين كلمة المرور (`/reset-password`).

### 2.2. ميزات المستخدم المسجل والعضو

هذه الميزات متاحة للمستخدمين المصادق عليهم وتوفر تجارب مخصصة وأدوات مشاركة مجتمعية.

- **لوحة معلومات مخصصة (`/my-dashboard`):** لوحة معلومات قابلة للتخصيص للمستخدمين للوصول إلى محتواهم وإشاراتهم المرجعية وإشعاراتهم.
- **إدارة الملف الشخصي (`/profile`):** تسمح للمستخدمين بتحديث معلوماتهم الشخصية وتغيير كلمة المرور وإدارة صورتهم الرمزية.
- **الإشارات المرجعية (`/bookmarks`):** تمكن المستخدمين من حفظ محتواهم المفضل للوصول إليه بسهولة لاحقًا.
- **الميزات التفاعلية:**
    - **قسم التعليقات:** يسمح للمستخدمين بالمشاركة في المناقشات حول المقالات الإخبارية والمحتويات الأخرى.
    - **زر الإعجاب:** يوفر آلية بسيطة للمستخدمين للتعبير عن تقديرهم للمحتوى.
- **خدمات حصرية للأعضاء (`/member`):** الوصول إلى محتوى وخدمات خاصة مخصصة للأعضاء المسجلين.

### 2.3. إدارة المحتوى والإدارة

هذه الميزات مقصورة على الأدوار الإدارية المصرح لها (المسؤول، مشرف المحتوى، المحرر) وتتم إدارتها من خلال لوحة تحكم إدارية مخصصة (`/dashboard`).

- **إنشاء وتحرير المحتوى:** محرر نصوص منسقة لإنشاء وتنسيق المقالات، مع دعم لتضمين الوسائط المتعددة.
- **سير عمل الموافقة على المحتوى (`/approval`):** عملية موافقة متعددة الخطوات للأخبار ومقاطع الفيديو، مما يسمح للمحررين بتقديم المحتوى وللمشرفين بمراجعته أو الموافقة عليه أو رفضه.
- **جدولة المحتوى (`/scheduling`):** القدرة على جدولة نشر الأخبار ومقاطع الفيديو لتاريخ ووقت مستقبلي.
- **إدارة المستخدمين والأدوار (`/users`, `/roles`):** أدوات للمسؤولين لإنشاء وتحرير وإدارة حسابات المستخدمين وأدوارهم المعينة.
- **التحليلات وإعداد التقارير (`/analytics`):** لوحة معلومات تحليلية شاملة توفر رؤى حول مشاركة المستخدمين وأداء المحتوى ونشاط النظام.
- **إعدادات النظام (`/smtp-settings`):** واجهة آمنة للمسؤولين لتكوين الإعدادات على مستوى النظام، مثل تكوينات خادم البريد الإلكتروني.

## 3. المتطلبات غير الوظيفية

تحدد المتطلبات غير الوظيفية الخصائص التشغيلية وسمات الجودة للنظام.

- **الأداء:** يجب أن تكون المنصة عالية الاستجابة، مع أوقات تحميل سريعة للصفحات وتفاعلات مستخدم سلسة، مدعومة بحزمة تقنية حديثة (React, Vite, Node.js) وجلب بيانات فعال (tRPC, React Query).
- **الأمان:** تدابير أمنية قوية ضرورية، بما في ذلك المصادقة الآمنة (JWT)، والتحكم في الوصول القائم على الأدوار، والحماية من الثغرات الأمنية الشائعة على الويب.
- **سهولة الاستخدام:** يجب أن تكون واجهة المستخدم بديهية وسهلة الوصول والتنقل لجميع مجموعات المستخدمين، مع تصميم نظيف وتخطيط متسق.
- **قابلية التوسع:** يجب أن تكون البنية قابلة للتطوير للتعامل مع قاعدة مستخدمين متنامية وحجم محتوى متزايد، مع الاستفادة من حل قاعدة بيانات قوي (MySQL/TiDB) وخدمات خلفية فعالة.
- **قابلية الصيانة:** يجب أن يكون الكود المصدري منظمًا جيدًا وموثقًا وسهل الصيانة، مع اتباع أفضل الممارسات لكل من تطوير الواجهة الأمامية (TypeScript, Radix UI) والخلفية (tRPC, Drizzle ORM).

## 4. متطلبات البيانات

تم تصميم نموذج بيانات المنصة لدعم أنواع المحتوى والوظائف المتنوعة. يقدم الجدول التالي نظرة عامة على جداول قاعدة البيانات الرئيسية والغرض منها.

| الجدول | الوصف |
| --- | --- |
| `news` | يخزن المقالات الإخبارية، بما في ذلك محتواها وبياناتها الوصفية وحالة النشر. |
| `videos` | يدير محتوى الفيديو، بما في ذلك عناوين URL والصور المصغرة والأوصاف وأذونات التشغيل. |
| `images` | يحتوي على معلومات حول الصور في المعرض، بما في ذلك عناوين URL وبياناتها الوصفية وأذونات التنزيل. |
| `guides` | يخزن المستندات والأدلة الرسمية، بما في ذلك مسارات الملفات والأنواع وقيود الوصول. |
| `presentations` | يدير ملفات العروض التقديمية، بما في ذلك عدد الشرائح والصور المصغرة وعلامات الوصول الحصري للأعضاء. |
| `links` | مجموعة من الروابط الخارجية المنسقة مع أوصاف وتصنيفات. |
| `guestbook` | يخزن إدخالات من سجل الزوار العام، بما في ذلك الرسائل وحالة الموافقة. |
| `tags` | يدير العلامات المستخدمة لتصنيف المحتوى عبر المنصة. |
| `users` | يحتوي على معلومات حساب المستخدم، بما في ذلك تفاصيل المصادقة والأدوار وبيانات الملف الشخصي. |
| `settings` | مخزن قيم مفتاحية لإعدادات التكوين على مستوى النظام. |

## 5. متطلبات API والتكامل

تعرض المنصة مجموعة شاملة من نقاط نهاية API عبر tRPC للاتصال بين العميل والخادم. يتم تنظيم نقاط النهاية هذه حسب الميزة وتوفر العمليات اللازمة لجميع تفاعلات المستخدم والمهام الإدارية.

### 5.1. المصادقة (`auth`)
- **الاستعلامات:** `me`
- **التعديلات:** `localLogin`, `logout`, `changePassword`, `requestPasswordReset`, `resetPassword`, `updateProfile`, `uploadAvatar`

### 5.2. إدارة المحتوى
- **الأخبار (`news`):**
  - **الاستعلامات:** `list`, `all`, `latest`, `getById`
  - **التعديلات:** `create`, `update`, `delete`
- **مقاطع الفيديو (`videos`):**
  - **الاستعلامات:** `list`, `all`
  - **التعديلات:** `create`, `update`, `delete`
- **الصور (`images`):**
  - **الاستعلامات:** `list`, `all`
  - **التعديلات:** `create`, `update`, `delete`
- **الأدلة (`guides`):**
  - **الاستعلامات:** `list`, `all`
  - **التعديلات:** `create`, `update`, `delete`
- **العروض التقديمية (`presentations`):**
  - **الاستعلامات:** `list`, `all`, `getById`
  - **التعديلات:** `create`, `update`, `delete`
- **الروابط (`links`):**
  - **الاستعلامات:** `list`, `all`
  - **التعديلات:** `create`, `update`, `delete`

### 5.3. المجتمع والمشاركة
- **سجل الزوار (`guestbook`):**
  - **الاستعلامات:** `list`, `all`
  - **التعديلات:** `create`, `approve`, `delete`
- **العلامات (`tags`):**
  - **الاستعلامات:** `list`, `getContentByTag`
  - **التعديلات:** `create`, `update`, `delete`
- **الإشارات المرجعية (`bookmarks`):**
  - **الاستعلامات:** `myBookmarks`, `isBookmarked`
  - **التعديلات:** `toggle`
- **الإشعارات (`notifications`):**
  - **الاستعلامات:** `list`, `unreadCount`
  - **التعديلات:** `markRead`, `markAllRead`

### 5.4. الإدارة والتنظيم
- **المستخدمون (`users`):**
  - **الاستعلامات:** `list`
  - **التعديلات:** `update`
- **التحليلات (`analytics`):**
  - **الاستعلامات:** `overview`, `activityByDay`, `bookmarksByType`, `commentsByMonth`, `contentByMonth`, `likesByType`, `recentActivity`, `topLiked`, `userRegistrations`
  - **التعديلات:** `generateReport`
- **لوحة التحكم (`dashboard`):**
  - **الاستعلامات:** `stats`
- **سير عمل الموافقة (`approval`):**
  - **الاستعلامات:** `mySubmissions`, `pendingNews`, `pendingVideos`
  - **التعديلات:** `submitNews`, `submitVideo`, `reviewNews`, `reviewVideo`
- **المراسلة (`messages`):**
  - **الاستعلامات:** `inbox`, `sent`, `unreadCount`, `users`
  - **التعديلات:** `send`, `broadcast`, `delete`, `markRead`, `markUnread`
- **إعدادات النظام (`settings`, `smtp`):**
  - **الاستعلامات:** `getAll`, `getConfig`
  - **التعديلات:** `set`, `saveConfig`, `testEmail`
- **تنظيم المحتوى (`scheduling`, `contentOrder`):**
  - **الاستعلامات:** `allNewsWithStatus`, `allVideosWithStatus`, `scheduledNews`, `scheduledVideos`, `getNews`, `getVideos`
  - **التعديلات:** `updateNewsStatus`, `updateVideoStatus`, `publishNow`, `updateNewsOrder`, `updateVideosOrder`
- **التقارير الأسبوعية (`weeklyReport`):**
  - **الاستعلامات:** `getData`, `getSettings`
  - **التعديلات:** `saveSettings`, `sendNow`

### 5.5. عام
- **البحث (`search`):**
  - **الاستعلامات:** `query`
